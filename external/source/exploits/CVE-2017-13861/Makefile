
CFLAGS=-fno-stack-protector -fno-exceptions -fpie -fPIC -fPIE -fpic
GCC_BIN_IOS=`xcrun --sdk iphoneos -f gcc`
GCC_BASE_IOS=$(GCC_BIN_IOS)
SDK_IOS=`xcrun --sdk iphoneos --show-sdk-path`
GCC_IOS=$(GCC_BASE_IOS) $(CFLAGS) -arch arm64 -isysroot $(SDK_IOS)

all: clean exploit.bin

main: main.c
	$(GCC_IOS) -o $@ $^

exploit.bin: main
	ruby create_bin.rb main

install: exploit.bin
	mkdir -p ../../../../data/exploits/CVE-2017-13861
	cp main ../../../../data/exploits/CVE-2017-13861/exploit

clean:
	rm -f *.o main exploit.bin

